# UI 效果模拟展示

## 场景 1：未读状态

```
┌─────────────────────────────────────────────────────────────┐
│                      书籍预览卡片（右侧边栏）                    │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│                    ┌─────────────────────┐                   │
│                    │                     │                   │
│                    │    书籍封面          │                   │
│                    │  (图片或颜色块)      │                   │
│                    │                     │                   │
│                    └─────────────────────┘                   │
│                                                               │
│                      活着                                      │
│                  (英文标题 To Live)                            │
│                      余华 著                                   │
│                                                               │
│                  ┌───────────────────────┐                   │
│                  │  ✓ Mark as read       │  ← 灰色按钮      │
│                  └───────────────────────┘                   │
│                                                               │
│                  ┌───────────────────────┐                   │
│                  │  🗑️  Remove           │  ← 灰色按钮      │
│                  └───────────────────────┘                   │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

**说明：** 书籍尚未被标记为已读，按钮文本是「Mark as read」（灰色）

---

## 场景 2：已读状态（标记后）

```
┌─────────────────────────────────────────────────────────────┐
│                      书籍预览卡片（右侧边栏）                    │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│                    ┌─────────────────────┐                   │
│                    │                     │                   │
│                    │    书籍封面          │                   │
│                    │  (图片或颜色块)      │                   │
│                    │                     │                   │
│                    └─────────────────────┘                   │
│                                                               │
│                      活着                                      │
│                  (英文标题 To Live)                            │
│                      余华 著                                   │
│                                                               │
│              ┌─────────────────────────┐                     │
│              │  ✓  Read  │ 绿色徽章     │                     │
│              └─────────────────────────┘                     │
│                                                               │
│                  ┌───────────────────────┐                   │
│                  │  ✓ Mark unread        │  ← 绿色按钮      │
│                  └───────────────────────┘                   │
│                                                               │
│                  ┌───────────────────────┐                   │
│                  │  🗑️  Remove           │  ← 灰色按钮      │
│                  └───────────────────────┘                   │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

**说明：** 
- ✅ 绿色徽章「✓ Read」出现
- ✅ 按钮文本变为「Mark unread」
- ✅ 按钮颜色变绿

---

## 场景 3：悬停按钮时

```
┌─────────────────────────────────────────────────────────────┐
│                      书籍预览卡片（右侧边栏）                    │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│                    ┌─────────────────────┐                   │
│                    │                     │                   │
│                    │    书籍封面          │                   │
│                    │  (图片或颜色块)      │                   │
│                    │                     │                   │
│                    └─────────────────────┘                   │
│                                                               │
│                      活着                                      │
│                  (英文标题 To Live)                            │
│                      余华 著                                   │
│                                                               │
│          ╔═══════════════════════════════╗                   │
│          ║ ✓ Mark as read                ║  ← 悬停：绿色     │
│          ║ (绿色边框，绿色背景)            ║    边框 + 高亮   │
│          ╚═══════════════════════════════╝                   │
│                                                               │
│                  ┌───────────────────────┐                   │
│                  │  🗑️  Remove           │                   │
│                  └───────────────────────┘                   │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

**说明：** 用户悬停在按钮上时，按钮出现绿色边框和背景高亮

---

## 完整的书架视图

```
                          OVID - 书架视图
┌──────────────────────────────────────────┬──────────────────────────┐
│                                          │                          │
│  ┌─────────────────────────────────┐    │   预览卡片（右侧边栏）    │
│  │ 书脊 │书脊│书脊│书脊│书脊│书脊 │    │                          │
│  │ [活] │[1] │[人] │[月] │[呼] │    │  ┌────────────────────────┐│
│  │ [着] │[9] │[生] │[亮] │[啸] │    │  │        书籍封面        ││
│  │     │[8] │    │    │    │    │    │  │                        ││
│  │ ↑   │[4] │ ↑  │ ↑  │ ↑  │ ↑  │    │  │    (400x600 图片)     ││
│  │ 悬   │    │ 可 │ 可 │ 可 │ 可 │    │  │                        ││
│  │ 停   │    │ 点 │ 点 │ 点 │ 点 │    │  └────────────────────────┘│
│  │ 时   │    │ 击 │ 击 │ 击 │ 击 │    │                          │
│  │ 显   │    │ 标 │ 标 │ 标 │ 标 │    │    活着                  │
│  │ 示   │    │ 记 │ 记 │ 记 │ 记 │    │  To Live / 余华          │
│  │     │    │    │    │    │    │    │                          │
│  │     │    │    │    │    │    │    │  ✓ Read (已读)           │
│  │     │    │    │    │    │    │    │                          │
│  │ 第一行：公共书（黄色） │ │  │ Mark unread    │
│  ├─────────────────────────────────┤  │  Remove                  │
│  │ 书脊 │书脊│书脊│            │  │  │                          │
│  │ [用] │[自] │[活] │            │  │  └────────────────────────┘│
│  │ [户] │[我] │[着] │            │  │                          │
│  │ [上] │[是] │    │            │  │  用户账户 🔘                │
│  │ [传] │[个] │ ↑  │            │  │  name@example.com         │
│  │ [1] │[故] │ 可 │            │  │                          │
│  │ [2] │[事] │ 点 │            │  │  💰 1000 credits          │
│  │     │    │    │            │  │                          │
│  │ 第二行：用户上传的书         │  │  Buy Credits              │
│  │                            │  │  Logout                   │
│  └──────────────────────────────────┴──────────────────────────┘
│                                         👆 底部：用户菜单         │
└──────────────────────────────────────────────────────────────────┘
```

---

## API 数据流

```
前端                          API                      数据库
 │                           │                         │
 │ 1. 用户点击"Mark as read"   │                         │
 ├────────────────────────────→│                         │
 │                            │                         │
 │                            │ 2. POST 请求             │
 │                            │ /api/book/:uuid/         │
 │                            │ mark-complete            │
 │                            │ {isCompleted: true}      │
 │                            │                         │
 │                            ├────────────────────────→│
 │                            │                         │
 │                            │ 3. 查询 user_id          │
 │                            │ 从认证 cookie            │
 │                            │                         │
 │                            ├─→ INSERT OR UPDATE      │
 │                            │   user_book_progress    │
 │                            │   is_completed = 1      │
 │                            │   completed_at = NOW()  │
 │                            │←─                       │
 │                            │                         │
 │ 4. 返回 progress 对象       │                         │
 │←────────────────────────────┤                         │
 │                            │                         │
 │ 5. 更新 bookProgressMap     │                         │
 │    [uuid] = progress        │                         │
 │                            │                         │
 │ 6. UI 重新渲染              │                         │
 │    显示绿色徽章             │                         │
 │    按钮文本变"Mark unread"   │                         │
 │                            │                         │
```

---

## 数据库表示例

### user_book_progress 表

```
┌────┬────────┬──────────────┬──────────────┬─────────────────┬─────────────────┐
│ id │user_id │ book_uuid    │ is_completed │  completed_at   │  last_read_at   │
├────┼────────┼──────────────┼──────────────┼─────────────────┼─────────────────┤
│ 1  │  123   │ book-1       │      1       │ 2026-02-15 ...  │ 2026-02-15 ...  │
│ 2  │  123   │ book-2       │      0       │     NULL        │ 2026-02-15 ...  │
│ 3  │  456   │ book-1       │      1       │ 2026-02-14 ...  │ 2026-02-14 ...  │
│ 4  │  456   │ book-3       │      1       │ 2026-02-15 ...  │ 2026-02-15 ...  │
└────┴────────┴──────────────┴──────────────┴─────────────────┴─────────────────┘

说明：
- 用户 123 标记了 book-1 为已读（已完成）
- 用户 123 标记了 book-2 为未读（进行中）
- 用户 456 标记了同一本 book-1 为已读，但时间独立（2026-02-14）
- 多用户可对同一本书有不同的状态 ✓
```

---

## 色彩方案

| 元素 | 颜色 | 用途 |
|------|------|------|
| 已读徽章 | `#4ade80` (绿色) | 标识已读状态 |
| 按钮边框（未读） | `#444` (深灰) | 未激活状态 |
| 按钮边框（已读） | `#4ade80` (绿色) | 激活状态 |
| 按钮背景（已读） | `rgba(74, 222, 128, 0.1)` | 轻微高亮 |
| 按钮背景（悬停） | `rgba(74, 222, 128, 0.05)` | 交互反馈 |

---

## CSS 类名速查

```css
.book-completed-badge        /* 绿色徽章「✓ Read」*/
.book-actions                /* 按钮容器（flex 列） */
.mark-complete-btn           /* 标记按钮（默认灰色） */
.mark-complete-btn.completed /* 已读状态（绿色） */
.remove-book-btn             /* 删除按钮（默认灰色） */
```

---

## 交互时序

```
用户操作                   前端状态                    API 请求                  数据库状态
   │                        │                           │                         │
   │ 悬停按钮                │                           │                         │
   │──────────→ 按钮显示高亮   │                           │                         │
   │                        │                           │                         │
   │ 点击                    │                           │                         │
   │──────────→ 禁用按钮     │                           │                         │
   │           显示加载态    │                           │                         │
   │                        │ POST                      │                         │
   │                        │ {isCompleted: true}       │────────────────────────→│
   │                        │                           │                         │
   │                        │                           │        CREATE/UPDATE    │
   │                        │                           │        user_book_       │
   │                        │                           │        progress         │
   │                        │                           │←────────────────────────│
   │                        │                           │                         │
   │                        │ 接收 progress             │                         │
   │                        │ 更新 map[uuid]            │                         │
   │                        │←────────────────────────────│                         │
   │                        │                           │                         │
   │                        │ 触发重新渲染               │                         │
   │←────────── 显示徽章      │                           │                         │
   │           按钮文本改变   │                           │                         │
   │           按钮启用       │                           │                         │
   │                        │                           │                         │
```

---

## 响应式布局

### 桌面版（> 768px）
```
┌──────────────────────────────────────────────────┬──────────────┐
│                   书架                            │  预览卡片    │
│   (占 ~70%)                                       │   (占 ~30%)  │
└──────────────────────────────────────────────────┴──────────────┘
```

### 移动版（< 768px）
```
┌────────────────────────────┐
│        书架                 │
│   (全宽)                   │
├────────────────────────────┤
│      预览卡片               │
│   (全宽，浮层)             │
└────────────────────────────┘
```

---

*设计完成日期：2026-02-15*
